<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>è±Šæ©‹ãŠè²·ã„ç‰©ãƒãƒƒãƒ—</title>
    
    <link rel="apple-touch-icon" href="icon.png">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        #map { height: 100vh; width: 100%; z-index: 1; }
        body { margin: 0; padding: 0; font-family: sans-serif; overflow: hidden; background: #f0f0f0; }

        /* --- ãƒœã‚¿ãƒ³ã®è¨­å®šï¼šå³ä¸Šã«å›ºå®š --- */
        #menu-toggle {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 3000; /* æœ€å‰é¢ */
            background: #1a73e8;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 18px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            cursor: pointer;
            font-size: 15px;
        }

        /* --- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®è¨­å®šï¼šãƒœã‚¿ãƒ³ã®ä¸‹ã«é‡ãªã‚‰ãªã„ã‚ˆã†ã«é…ç½® --- */
        #menu {
            position: fixed;
            top: 75px; /* ãƒœã‚¿ãƒ³(ç´„50px) + ä½™ç™½åˆ†ã ã‘ä¸‹ã«é…ç½® */
            right: 15px;
            z-index: 2000;
            background: rgba(255, 255, 255, 0.98);
            width: 240px;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            max-height: 70vh;
            overflow-y: auto;
            transition: opacity 0.3s ease, transform 0.3s ease;
            
            /* åˆæœŸçŠ¶æ…‹ï¼šéš ã™ */
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
        }

        /* è¡¨ç¤ºçŠ¶æ…‹ */
        #menu.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .menu-item { margin-bottom: 10px; display: block; font-size: 14px; cursor: pointer; }
        .menu-item input { transform: scale(1.1); margin-right: 8px; vertical-align: middle; }
        
        #search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
            margin-bottom: 8px;
        }

        #search-results { 
            background: #f8f9fa; 
            border-radius: 8px;
            max-height: 150px;
            overflow-y: auto;
        }

        /* ç¾åœ¨åœ°ãƒœã‚¿ãƒ³ï¼ˆå·¦ä¸‹ï¼‰ */
        .location-btn {
            position: fixed;
            bottom: 30px;
            left: 20px;
            z-index: 1000;
            background: white;
            border-radius: 50%;
            width: 65px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 3px solid #1a73e8;
        }

        .route-btn {
            display: block;
            margin-top: 10px;
            padding: 15px;
            background: #1a73e8;
            color: white !important;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 15px;
        }
    </style>
</head>
<body>

<button id="menu-toggle" onclick="toggleMenu()">ğŸ” æ¤œç´¢ãƒ»çµã‚Šè¾¼ã¿</button>

<div id="menu">
    <strong style="display:block; margin-bottom:8px;">ğŸ” åº—èˆ—åã§æ¢ã™</strong>
    <input type="text" id="search-box" placeholder="åº—åã‚’æ¤œç´¢...">
    <div id="search-results"></div>
    
    <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
    
    <strong style="display:block; margin-bottom:8px;">ğŸ“‚ ã‚«ãƒ†ã‚´ãƒªçµã‚Šè¾¼ã¿</strong>
    <div id="category-filters"></div>
</div>

<div id="map"></div>
<div class="location-btn" onclick="goToMyLocation()">ğŸ“</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    function toggleMenu() {
        document.getElementById('menu').classList.toggle('show');
    }

    const map = L.map('map', { zoomControl: false }).setView([34.7628, 137.3817], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    const categoryColors = {
        "ã‚¹ãƒ¼ãƒ‘ãƒ¼": "#ff4757", "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼": "#2f3542", "ãƒ‰ãƒ©ãƒƒã‚°ã‚¹ãƒˆã‚¢": "#2ed573",
        "JA": "#ffa502", "ç›´è²©æ‰€": "#7bed9f", "å…«ç™¾å±‹": "#ff6348", "æœç‰©å±‹": "#eccc68",
        "é­šå±‹": "#1e90ff", "ãƒ–ãƒ©ã‚¸ãƒ«é£Ÿå“": "#3742fa", "ãƒ™ãƒˆãƒŠãƒ é£Ÿå“": "#ff7f50", "é£Ÿå“å€‰åº«": "#a4b0be"
    };

// 2. åº—èˆ—ãƒ‡ãƒ¼ã‚¿ï¼ˆæ•´ç†æ¸ˆã¿å…¨ãƒªã‚¹ãƒˆï¼‰
const stores = [
// --- ä¾¡æ ¼è©³ç´°ã‚ã‚Šåº—èˆ— ---
{ "name": "ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒãƒ¼ã‚±ãƒƒãƒˆãƒãƒ­ãƒ¼è±Šæ©‹åº—", "lat": 34.75506494, "lng": 137.3934868, "info1": "ãƒ«ãƒ“ãƒƒãƒˆã‚¢ãƒ—ãƒªãƒã‚§ãƒƒã‚¯ ãƒã‚¤ãƒ³ãƒˆè²¯ã¾ã‚‹ï¼", "info2": "ç·èœãƒ‘ãƒ³ï¼‘ï¼ï¼å††ï¼", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼", "price": "ğŸ·è±šã“ã¾ L:118 SM:128 / ğŸ”ã‚€ã­:88 ã‚‚ã‚‚:108 ã•ã•ã¿:98 / ğŸ¥šãŸã¾ã”:278 / ğŸ§Šã¨ã†ãµ(350g):58 / ğŸ“œã‚ã¶ã‚‰ã‚ã’(8æš):98" },
{ "name": "ãƒ©ãƒ»ãƒ ãƒ¼ è±Šæ©‹åº—", "lat": 34.7527907, "lng": 137.3725441, "info1": "ä½•ã‚‚ã‹ã‚‚å®‰ã„", "info2": "å¼å½“300å††", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼", "price": "ğŸ·è±šã“ã¾ L:96 SM:109 / ğŸ”ã‚€ã­:68~79 ã‚‚ã‚‚:94~119 / ğŸ¥šãŸã¾ã”:289 / ğŸ§Šã¨ã†ãµ(400g):49 (320g):42 / ğŸœã†ã©ã‚“ãƒ»ã‚„ããã°:18 ä¸­è¯éºº:29 / ğŸ“œã‚ã¶ã‚‰ã‚ã’(8æš):89 (12æš):128" },
{ "name": "ãƒãƒƒã‚¯ã‚¹ãƒãƒªãƒ¥è±Šæ©‹æ©‹è‰¯åº—", "lat": 34.74103063, "lng": 137.3758915, "info1": "è±†è…ã¨æ²¹æšã’ãŒå®‰ã„", "info2": "ï¼’ï¼æ—¥ï¼“ï¼æ—¥5ï¼…ã‚ªãƒ•", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼", "price": "ğŸ·è±šã“ã¾:98 / ğŸ”ã‚€ã­:75~78 ã‚‚ã‚‚:95~98 / ğŸ‚ğŸ·ç‰›è±šåˆæŒ½:98~158 / ğŸ§Šã¨ã†ãµ(300g):41 / ğŸ“œã‚ã¶ã‚‰ã‚ã’(8æš):81 / ğŸœã†ã©ã‚“ãƒ»ã‚„ããã°:27" },
{ "name": "ã‚¤ã‚ªãƒ³ è±Šæ©‹å—åº—", "lat": 34.71087347, "lng": 137.388593, "info1": "WAONãƒã‚¤ãƒ³ãƒˆãŒè²¯ã¾ã‚‹ï¼", "info2": "ï¼’ï¼æ—¥ï¼“ï¼æ—¥5ï¼…ã‚ªãƒ•", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼", "price": "ğŸ·è±šã“ã¾:128 / ğŸ”ã‚€ã­(çš®ç„¡):98 ã‚‚ã‚‚:108~118 / ğŸ‚ğŸ·è±šã¿ã‚“ã¡:138 / ğŸ§Šã¨ã†ãµ(400g):58 / ğŸ“œã‚ã¶ã‚‰ã‚ã’:118 / ğŸœã†ã©ã‚“:27" },
{ "name": "ã‚«ãƒã‚¹ã‚¨ è±Šæ©‹ä¸­æµœåº—", "lat": 34.73963821, "lng": 137.3756906, "info1": "ã¨ã«ã‹ãå®‰ã„", "info2": "ãƒ¡ãƒ³ãƒãƒ¼ã‚ºã‚«ãƒ¼ãƒ‰ã§ç¾é‡‘æ‰•æ™‚3ï¼…ã‚ªãƒ•", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼", "price": "ğŸ·è±šã“ã¾:85~97 / ğŸ”ã‚€ã­:69~75 ã‚‚ã‚‚:95~99 ã•ã•ã¿:87 / ğŸ¥šãŸã¾ã”:237 / ğŸ§Šã¨ã†ãµ(320g):38 / ğŸœã†ã©ã‚“ãƒ»ã‚„ããã°:22 / ğŸ“œã‚ã¶ã‚‰ã‚ã’:79" },

// --- JAãƒ»ç”£ç›´ ---
{ "name": "ï¼ªï¼¡è±Šæ©‹ ï¼¡ã‚³ãƒ¼ãƒ— ç”£ç›´ãƒ—ãƒ©ã‚¶äºŒå·", "lat": 34.72824464, "lng": 137.4590064, "info1": "-", "info2": "-", "category": "JA" },
{ "name": "JAãƒ•ã‚¡ãƒ¼ãƒãƒ¼ã‚ºãƒãƒ¼ã‚±ãƒƒãƒˆå‰ç”°æ–¹åº—", "lat": 34.77288067, "lng": 137.3711233, "info1": "-", "info2": "-", "category": "JA" },
{ "name": "ï¼ªï¼¡ã‚°ãƒªãƒ¼ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼ ç£¯è¾º", "lat": 34.73167932, "lng": 137.3709979, "info1": "-", "info2": "-", "category": "JA" },

// --- ã‚¹ãƒ¼ãƒ‘ãƒ¼ï¼ˆè¿½åŠ åˆ†ï¼‰ ---
{ "name": "ãƒ•ãƒ¼ãƒ‰ã‚·ãƒ§ãƒƒãƒ—ã‚³ãƒ­ãƒŠ", "lat": 34.73963163, "lng": 137.3994956, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¯ãƒƒã‚¯ãƒãƒ¼ãƒˆ ç‰›å·åº—", "lat": 34.77822998, "lng": 137.4205802, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ•ãƒ¼ãƒ‰ãƒãƒ¼ã‚±ãƒƒãƒˆ ãƒãƒ  ç‰›å·åº—", "lat": 34.78190537, "lng": 137.4238281, "info1": "æ¥½å¤©ãƒã‚¤ãƒ³ãƒˆè²¯ã¾ã‚‹", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¢ãƒ”ã‚¿å‘å±±åº—", "lat": 34.75552701, "lng": 137.4017918, "info1": "ç«‹ä½“é§è»Šå ´æœ‰", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‹ãƒ¥ãƒ¼ãƒ©ã‚¤ãƒ• ãƒ•ã‚¸ ãŸã‹ä¸˜åº—", "lat": 34.77560081, "lng": 137.4267462, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚µãƒ³ãƒ¨ãƒ æ±åº—", "lat": 34.76128794, "lng": 137.414644, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚µãƒ³ãƒ¨ãƒ é­šç”ºæœ¬åº—", "lat": 34.76768673, "lng": 137.3885217, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒãƒ¼ã‚±ãƒƒãƒˆãƒãƒ­ãƒ¼è±Šæ©‹è°å£åº—", "lat": 34.77087713, "lng": 137.3738837, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ“ã‚ªãƒ»ã‚ã¤ã¿ ã‚¨ãƒ”ã‚¹ãƒªãƒ¼è±Šæ©‹", "lat": 34.74993458, "lng": 137.4103618, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¯ãƒƒã‚¯ãƒãƒ¼ãƒˆ é£¯æ‘åº—", "lat": 34.74838307, "lng": 137.430532, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¯ãƒƒã‚¯ãƒãƒ¼ãƒˆæ±è„‡åº—", "lat": 34.7544479, "lng": 137.3683476, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¨ã‚¯ãƒœã‚¹ã‚¿ã‚¤ãƒ«ã“ã‚‚ãã¡", "lat": 34.74914356, "lng": 137.3728701, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "MEGAãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ† è±Šæ©‹åº—", "lat": 34.744081, "lng": 137.3720384, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ•ãƒ¼ãƒ‰ãƒãƒ¼ã‚±ãƒƒãƒˆ ãƒãƒ  ç‰§é‡åº—", "lat": 34.73392441, "lng": 137.3998475, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¯ãƒƒã‚¯ãƒãƒ¼ãƒˆ ãƒ¦ãƒ¼ã‚¢ã‚¤åº—", "lat": 34.73455923, "lng": 137.3954701, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚ªãƒ¼ã‚¯ãƒ¯ è±Šæ©‹ãƒŸãƒ©ã¾ã¡åº—", "lat": 34.73060914, "lng": 137.3887753, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ¤ãƒãƒŠã‚« äºŒå·åº—", "lat": 34.7291278, "lng": 137.4307466, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "é é‰„ã‚¹ãƒˆã‚¢ è±Šæ©‹æ›™åº—", "lat": 34.72630614, "lng": 137.3987317, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚µãƒ³ãƒ¨ãƒ é«˜å¸«åº—", "lat": 34.72454255, "lng": 137.3874021, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‰ãƒŸãƒ¼ é£¯æ‘åº—", "lat": 34.74505075, "lng": 137.4269056, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‹ãƒ¥ãƒ¼ãƒ©ã‚¤ãƒ•ãƒ•ã‚¸ äºŒå·åº—", "lat": 34.72371457, "lng": 137.4506366, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãŸã¤ã¿ã‚¹ãƒˆã‚¢ãƒ¼ äºŒå·åº—", "lat": 34.72807687, "lng": 137.4549236, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "DUY THUá»¶ MART", "lat": 34.72641395, "lng": 137.4281978, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‹ãƒ¥ãƒ¼ãƒ©ã‚¤ãƒ•ãƒ•ã‚¸ è¥¿å£åº—", "lat": 34.74411626, "lng": 137.4117133, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãŸã¤ã¿ã‚¹ãƒˆã‚¢ãƒ¼å¤§æ¸…æ°´åº—", "lat": 34.70108326, "lng": 137.3585841, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒãƒƒã‚¯ã‚¹ãƒãƒªãƒ¥è±Šæ©‹å—åº—", "lat": 34.70073044, "lng": 137.3559233, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã»ãªã¿ é£Ÿå½©åºƒå ´å¤§æ¸…æ°´åº—", "lat": 34.69720214, "lng": 137.3596999, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ”ã‚¢ã‚´å¤§æ¸…æ°´åº—", "lat": 34.68718093, "lng": 137.3613306, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒãƒƒã‚¯ã‚¹ãƒãƒªãƒ¥ è±Šæ©‹å¯Œå£«è¦‹å°åº—", "lat": 34.68301684, "lng": 137.3627039, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‰ãƒŸãƒ¼ã¤ã¤ã˜ãŒä¸˜åº—", "lat": 34.74487248, "lng": 137.4017445, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒãƒ¼ã‚±ãƒƒãƒˆãƒãƒ­ãƒ¼ç‰Ÿå‘‚åº—", "lat": 34.74839499, "lng": 137.3617328, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒãƒ«ãƒã‚µ ç‰Ÿå‘‚åº—", "lat": 34.75074324, "lng": 137.3587728, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ¤ãƒãƒŠã‚« èµ¤å²©ãƒ•ãƒ©ãƒ³ãƒ†é¤¨", "lat": 34.76531502, "lng": 137.427249, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ¤ãƒãƒŠã‚« æ±ç”°ãƒ•ãƒ©ãƒ³ãƒ†é¤¨", "lat": 34.75300757, "lng": 137.3777579, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ¤ãƒãƒŠã‚« è±Šæ©‹ãƒ•ãƒ©ãƒ³ãƒ†é¤¨", "lat": 34.73767069, "lng": 137.3766088, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ¤ãƒãƒŠã‚« è¥¿ç¾½ç”°åº—", "lat": 34.76348175, "lng": 137.371974, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒãƒ¼ãƒˆãƒ†ãƒ©ãƒ€", "lat": 34.76181733, "lng": 137.4203225, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‰ãƒŸãƒ¼ æ¸¡æ´¥åº—", "lat": 34.77082333, "lng": 137.3559812, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ•ãƒ¼ãƒ‰ã‚·ãƒ§ãƒƒãƒ— ã‚³ãƒ­ãƒŠå°å‚äº•åº—", "lat": 34.80022632, "lng": 137.3538818, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¨ã‚¯ãƒœã‚¹ã‚¿ã‚¤ãƒ«ã‚ã‘ã¼ã®", "lat": 34.7270607, "lng": 137.4021882, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¨ã‚¯ãƒœã‚¹ã‚¿ã‚¤ãƒ«ã¯ã—ã‚‰", "lat": 34.7492163, "lng": 137.3732571, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‹ãƒ¥ãƒ¼ãƒ©ã‚¤ãƒ•ãƒ•ã‚¸ æœ¬éƒ¨", "lat": 34.75447394, "lng": 137.4313896, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ•ãƒ¼ãƒ‰ã‚ªã‚¢ã‚·ã‚¹ã‚ã¤ã¿ å±±ç”°åº—", "lat": 34.74511655, "lng": 137.3920453, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚³ãƒ¼ãƒ—å²©ç”°", "lat": 34.75389435, "lng": 137.4197032, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ãƒ‹ãƒ¥ãƒ¼ãƒ©ã‚¤ãƒ•ãƒ•ã‚¸ å²©ç”°åº—", "lat": 34.75442907, "lng": 137.4313119, "info1": "-", "info2": "-", "category": "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },

// --- ãã®ä»–ã‚«ãƒ†ã‚´ãƒª ---
{ "name": "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼ è±Šæ©‹åº—", "lat": 34.74091018, "lng": 137.3926525, "info1": "-", "info2": "-", "category": "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼ äºŒå·åº—", "lat": 34.7286575, "lng": 137.4494971, "info1": "-", "info2": "-", "category": "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¢ãƒŸã‚« è±Šæ©‹åº—", "lat": 34.752176, "lng": 137.3766466, "info1": "-", "info2": "-", "category": "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ã‚¢ãƒŸã‚« è±Šæ©‹ä½è—¤åº—", "lat": 34.742212, "lng": 137.4095675, "info1": "-", "info2": "-", "category": "æ¥­å‹™ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
{ "name": "ï¼¶ãƒ»drug è±Šæ©‹ç‰›å·åº—", "lat": 34.7818512, "lng": 137.4155411, "info1": "ãŠè‚‰ã‚‚å°‘ã—å£²ã£ã¦ã‚‹", "info2": "æ°´ãƒ»åœŸãƒã‚¤ãƒ³ãƒˆ3å€ï¼ï¼ï¼", "category": "ãƒ‰ãƒ©ãƒƒã‚°ã‚¹ãƒˆã‚¢" },
{ "name": "ãƒœãƒ³ ãƒ–ãƒ©ã‚¸ãƒ«", "lat": 34.73640865, "lng": 137.3740994, "info1": "-", "info2": "-", "category": "ãƒ–ãƒ©ã‚¸ãƒ«é£Ÿå“" },
{ "name": "The Amigos å²©å±‹", "lat": 34.73826865, "lng": 137.4238417, "info1": "-", "info2": "-", "category": "ãƒ–ãƒ©ã‚¸ãƒ«é£Ÿå“" },
{ "name": "ãˆ±SANPHAMVIET", "lat": 34.76867465, "lng": 137.3828999, "info1": "-", "info2": "-", "category": "ãƒ™ãƒˆãƒŠãƒ é£Ÿå“" },
{ "name": "éˆ´æœ¨ãƒ•ãƒ«ãƒ¼ãƒ„", "lat": 34.76514, "lng": 137.3826478, "info1": "-", "info2": "-", "category": "æœç‰©å±‹" },
{ "name": "å±±å®‰ é­šå¸‚å ´åº—", "lat": 34.79047149, "lng": 137.369784, "info1": "-", "info2": "-", "category": "é­šå±‹" },
{ "name": "ãƒ‘ãƒ¯ãƒ¼ã‚º æ±è„‡åº—", "lat": 34.74997408, "lng": 137.3628205, "info1": "-", "info2": "-", "category": "é£Ÿå“å€‰åº«" },
{ "name": "å¤ç›®å•†åº—", "lat": 34.76045216, "lng": 137.3550955, "info1": "ã†ãªã", "info2": "-", "category": "ç›´è²©æ‰€" },
{ "name": "ç”ºã®ãŠæƒ£èœå±‹ã•ã‚“ã‚„ã¾ã‚„", "lat": 34.76627433, "lng": 137.3890173, "info1": "-", "info2": "-", "category": "å…«ç™¾å±‹" }
];
    const markers = [];
    stores.forEach(store => {
        if (store.lat && store.lng) {
            const markerColor = categoryColors[store.category] || "#747d8c";
            const marker = L.circleMarker([store.lat, store.lng], {
                radius: 15, 
                fillColor: markerColor,
                color: "#ffffff",
                weight: 3,
                opacity: 1,
                fillOpacity: 0.9
            });

            const priceHtml = store.price ? `<div style="margin-top:8px; padding:10px; background:#fffdf0; border-radius:6px; font-size:14px; border:1px solid #ffeaa7;">${store.price.split(' / ').join('<br>')}</div>` : "";
            
            const popupContent = `
                <div style="font-size:16px; min-width:180px;">
                    <strong>${store.name}</strong><br>
                    <span style="font-size:13px; color:#666;">${store.info1 || ""}</span>
                    ${priceHtml}
                    <a href="https://www.google.com/maps/dir/?api=1&destination=${store.lat},${store.lng}" target="_blank" class="route-btn">ğŸš— ã“ã“ã¸è¡Œã</a>
                </div>
            `;
            marker.bindPopup(popupContent);
            marker.myCategory = store.category;
            marker.myName = store.name;
            markers.push(marker);
            marker.addTo(map);
        }
    });

    const filterContainer = document.getElementById('category-filters');
    const searchBox = document.getElementById('search-box');
    const resultsContainer = document.getElementById('search-results');
    const categories = [...new Set(stores.map(s => s.category))];

    categories.forEach(cat => {
        const label = document.createElement('label');
        label.className = 'menu-item';
        label.innerHTML = `<input type="checkbox" class="cat-check" checked value="${cat}"> ${cat}`;
        filterContainer.appendChild(label);
        label.querySelector('input').addEventListener('change', updateFilters);
    });

    function updateFilters() {
        const searchText = searchBox.value.toLowerCase();
        const checkedCats = Array.from(filterContainer.querySelectorAll('.cat-check:checked')).map(i => i.value);
        resultsContainer.innerHTML = '';

        markers.forEach(m => {
            const isCatMatch = checkedCats.includes(m.myCategory);
            const isSearchMatch = m.myName.toLowerCase().includes(searchText);

            if (isCatMatch && isSearchMatch) {
                map.addLayer(m);
                if (searchText.length > 0) {
                    const d = document.createElement('div');
                    d.style = 'padding:12px; border-bottom:1px solid #eee; cursor:pointer; font-size:14px;';
                    d.innerText = m.myName;
                    d.onclick = () => { map.flyTo(m.getLatLng(), 16); m.openPopup(); toggleMenu(); };
                    resultsContainer.appendChild(d);
                }
            } else {
                map.removeLayer(m);
            }
        });
    }
    searchBox.addEventListener('input', updateFilters);

    function goToMyLocation() {
        navigator.geolocation.getCurrentPosition(pos => {
            const latlng = [pos.coords.latitude, pos.coords.longitude];
            L.circleMarker(latlng, { radius: 10, color: '#1a73e8', fillColor: '#1a73e8', fillOpacity: 0.8 }).addTo(map).bindPopup("ç¾åœ¨åœ°").openPopup();
            map.flyTo(latlng, 16);
        }, err => alert("ä½ç½®æƒ…å ±ã‚’è¨±å¯ã—ã¦ãã ã•ã„"));
    }
</script>
</body>
</html>
